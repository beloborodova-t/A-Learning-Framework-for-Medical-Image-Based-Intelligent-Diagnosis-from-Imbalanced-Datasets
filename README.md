# Deep-Oversampling-Technique-for-4-level-Acne-Classification-in-Imbalanced-Data
This is a Python implementation of Deep Oversampling Technique for 4-level Acne Classification in Imbalanced Data paper.
## Methodology
We assume imbalanced dataset **_S_** with m objects |**_S_**| = **_m_**, as a pair **_S_** = {(**_x_**_i_, **_y_**_i_)}, **_i_** = **1**, ..., **_m_**, where **_x_**_i_ **ϵ _X_** denotes the instance in the **_n_**-dimensional feature space **_X_**={***f***1, ***f***2, ..., ***f***_n_}, and ***y***_i_  ϵ ***Y*** = {**1**, …, ***C***} denotes the class identifier label associated with ***x***_i_. in particular, when ***C*** = 2 we deal with binary classification task. In addition, we define subsets ***S***min ⊂ ***S*** and ***S***maj ⊂ ***S***, where ***S***min is the set of minority objects of classes in ***S***, and ***S***maj is the set of objects of prevailing classes in ***S***, so that ***S***min ∩ ***S***maj = {Φ} and ***S***min ᴜ ***S***maj = {***S***}. Based on these assumptions the problem of acne recognition can be formulated as a 4-type classification task. 
Thereafter, the multiclass classification problem is transformed into a regression task. This transformation helps to reduce possible subjectivity in the assessment of the acne severity at the stage of data annotation. Since the acne levels class have a meaningful ordering, we assign the numeric values from **0** to ***C*** to each of the corresponding ***C*** classes labels. Formally, it presented as follow ***y***  ⊆ ***S*** = {**1**, …, ***C***}→transformation→***y*** ϵ **ℝ**_n_. The values of the class variable are transformed into numbers. A numeric target is corresponding to a level of acne severity.
Thresholding is also used to transform back a regression prediction into a classification prediction ***y'*** ϵ ℝ*n*→transformation→***y'*** ⊆ ***S***, where ***y'*** is a prediction.
The proposed methodology includes dealing with imbalanced images dataset at the data level and feature level. At the data level, the following methods have been used: patch extraction and data augmentation. At the feature level, an oversampling technique has been used to deal with imbalanced data.
Firstly, we extract patches from original images of human faces using one of the two pre-trained models. Then data augmentation, feature extraction, and data oversampling are conducted. Finally, results obtained after oversampling are fed to CNN for model training and evaluation.

## Data
For this study the [ACNE04](https://github.com/xpwu95/ldl) the open dataset was used. The [ACNE04](https://github.com/xpwu95/ldl) includes 1457 face images and expert annotations according to the Japanese rating scale. The dataset has the following acne severity annotations: level 0 – Mild, level 1 – Moderate, level 2 – Severe, level 3 – Very severe. All images were taken at an angle of approximately 70 degrees from the front of the patient and manually annotated by experts.
